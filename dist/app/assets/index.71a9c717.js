(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const A of document.querySelectorAll('link[rel="modulepreload"]'))D(A);new MutationObserver(A=>{for(const H of A)if(H.type==="childList")for(const T of H.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&D(T)}).observe(document,{childList:!0,subtree:!0});function C(A){const H={};return A.integrity&&(H.integrity=A.integrity),A.referrerpolicy&&(H.referrerPolicy=A.referrerpolicy),A.crossorigin==="use-credentials"?H.credentials="include":A.crossorigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function D(A){if(A.ep)return;A.ep=!0;const H=C(A);fetch(A.href,H)}})();var pe={exports:{}};(function(ge,y){(function(C,D){ge.exports=D()})(self,function(){return(()=>{var C={22:(T,P,I)=>{var p=I(481),d=I(426),c=d;c.v1=p,c.v4=d,T.exports=c},725:T=>{for(var P=[],I=0;I<256;++I)P[I]=(I+256).toString(16).substr(1);T.exports=function(p,d){var c=d||0,L=P;return[L[p[c++]],L[p[c++]],L[p[c++]],L[p[c++]],"-",L[p[c++]],L[p[c++]],"-",L[p[c++]],L[p[c++]],"-",L[p[c++]],L[p[c++]],"-",L[p[c++]],L[p[c++]],L[p[c++]],L[p[c++]],L[p[c++]],L[p[c++]]].join("")}},157:T=>{var P=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(P){var I=new Uint8Array(16);T.exports=function(){return P(I),I}}else{var p=new Array(16);T.exports=function(){for(var d,c=0;c<16;c++)(3&c)==0&&(d=4294967296*Math.random()),p[c]=d>>>((3&c)<<3)&255;return p}}},481:(T,P,I)=>{var p,d,c=I(157),L=I(725),i=0,F=0;T.exports=function(w,R,z){var W=R&&z||0,_=R||[],K=(w=w||{}).node||p,G=w.clockseq!==void 0?w.clockseq:d;if(K==null||G==null){var $=c();K==null&&(K=p=[1|$[0],$[1],$[2],$[3],$[4],$[5]]),G==null&&(G=d=16383&($[6]<<8|$[7]))}var ee=w.msecs!==void 0?w.msecs:new Date().getTime(),h=w.nsecs!==void 0?w.nsecs:F+1,se=ee-i+(h-F)/1e4;if(se<0&&w.clockseq===void 0&&(G=G+1&16383),(se<0||ee>i)&&w.nsecs===void 0&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=ee,F=h,d=G;var Y=(1e4*(268435455&(ee+=122192928e5))+h)%4294967296;_[W++]=Y>>>24&255,_[W++]=Y>>>16&255,_[W++]=Y>>>8&255,_[W++]=255&Y;var ne=ee/4294967296*1e4&268435455;_[W++]=ne>>>8&255,_[W++]=255&ne,_[W++]=ne>>>24&15|16,_[W++]=ne>>>16&255,_[W++]=G>>>8|128,_[W++]=255&G;for(var m=0;m<6;++m)_[W+m]=K[m];return R||L(_)}},426:(T,P,I)=>{var p=I(157),d=I(725);T.exports=function(c,L,i){var F=L&&i||0;typeof c=="string"&&(L=c==="binary"?new Array(16):null,c=null);var w=(c=c||{}).random||(c.rng||p)();if(w[6]=15&w[6]|64,w[8]=63&w[8]|128,L)for(var R=0;R<16;++R)L[F+R]=w[R];return L||d(w)}},227:(T,P,I)=>{P.formatArgs=function(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+T.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;d.splice(1,0,c,"color: inherit");let L=0,i=0;d[0].replace(/%[a-zA-Z%]/g,F=>{F!=="%%"&&(L++,F==="%c"&&(i=L))}),d.splice(i,0,c)},P.save=function(d){try{d?P.storage.setItem("debug",d):P.storage.removeItem("debug")}catch{}},P.load=function(){let d;try{d=P.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=process.env.DEBUG),d},P.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},P.storage=function(){try{return localStorage}catch{}}(),P.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),P.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],P.log=console.debug||console.log||(()=>{}),T.exports=I(447)(P);const{formatters:p}=T.exports;p.j=function(d){try{return JSON.stringify(d)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}},447:(T,P,I)=>{T.exports=function(p){function d(i){let F,w,R,z=null;function W(..._){if(!W.enabled)return;const K=W,G=Number(new Date),$=G-(F||G);K.diff=$,K.prev=F,K.curr=G,F=G,_[0]=d.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let ee=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(h,se)=>{if(h==="%%")return"%";ee++;const Y=d.formatters[se];if(typeof Y=="function"){const ne=_[ee];h=Y.call(K,ne),_.splice(ee,1),ee--}return h}),d.formatArgs.call(K,_),(K.log||d.log).apply(K,_)}return W.namespace=i,W.useColors=d.useColors(),W.color=d.selectColor(i),W.extend=c,W.destroy=d.destroy,Object.defineProperty(W,"enabled",{enumerable:!0,configurable:!1,get:()=>z!==null?z:(w!==d.namespaces&&(w=d.namespaces,R=d.enabled(i)),R),set:_=>{z=_}}),typeof d.init=="function"&&d.init(W),W}function c(i,F){const w=d(this.namespace+(F===void 0?":":F)+i);return w.log=this.log,w}function L(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}return d.debug=d,d.default=d,d.coerce=function(i){return i instanceof Error?i.stack||i.message:i},d.disable=function(){const i=[...d.names.map(L),...d.skips.map(L).map(F=>"-"+F)].join(",");return d.enable(""),i},d.enable=function(i){let F;d.save(i),d.namespaces=i,d.names=[],d.skips=[];const w=(typeof i=="string"?i:"").split(/[\s,]+/),R=w.length;for(F=0;F<R;F++)w[F]&&((i=w[F].replace(/\*/g,".*?"))[0]==="-"?d.skips.push(new RegExp("^"+i.substr(1)+"$")):d.names.push(new RegExp("^"+i+"$")))},d.enabled=function(i){if(i[i.length-1]==="*")return!0;let F,w;for(F=0,w=d.skips.length;F<w;F++)if(d.skips[F].test(i))return!1;for(F=0,w=d.names.length;F<w;F++)if(d.names[F].test(i))return!0;return!1},d.humanize=I(824),d.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(p).forEach(i=>{d[i]=p[i]}),d.names=[],d.skips=[],d.formatters={},d.selectColor=function(i){let F=0;for(let w=0;w<i.length;w++)F=(F<<5)-F+i.charCodeAt(w),F|=0;return d.colors[Math.abs(F)%d.colors.length]},d.enable(d.load()),d}},824:T=>{var P=1e3,I=60*P,p=60*I,d=24*p;function c(w){if(!((w=String(w)).length>100)){var R=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(w);if(R){var z=parseFloat(R[1]);switch((R[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*z;case"weeks":case"week":case"w":return 6048e5*z;case"days":case"day":case"d":return z*d;case"hours":case"hour":case"hrs":case"hr":case"h":return z*p;case"minutes":case"minute":case"mins":case"min":case"m":return z*I;case"seconds":case"second":case"secs":case"sec":case"s":return z*P;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return z;default:return}}}}function L(w){var R=Math.abs(w);return R>=d?Math.round(w/d)+"d":R>=p?Math.round(w/p)+"h":R>=I?Math.round(w/I)+"m":R>=P?Math.round(w/P)+"s":w+"ms"}function i(w){var R=Math.abs(w);return R>=d?F(w,R,d,"day"):R>=p?F(w,R,p,"hour"):R>=I?F(w,R,I,"minute"):R>=P?F(w,R,P,"second"):w+" ms"}function F(w,R,z,W){var _=R>=1.5*z;return Math.round(w/z)+" "+W+(_?"s":"")}T.exports=function(w,R){R=R||{};var z=typeof w;if(z==="string"&&w.length>0)return c(w);if(z==="number"&&isFinite(w))return R.long?i(w):L(w);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(w))}}},D={};function A(T){var P=D[T];if(P!==void 0)return P.exports;var I=D[T]={exports:{}};return C[T](I,I.exports,A),I.exports}A.d=(T,P)=>{for(var I in P)A.o(P,I)&&!A.o(T,I)&&Object.defineProperty(T,I,{enumerable:!0,get:P[I]})},A.o=(T,P)=>Object.prototype.hasOwnProperty.call(T,P),A.r=T=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})};var H={};return(()=>{A.r(H),A.d(H,{ActionObjectType:()=>P,ChannelType:()=>se,ChildAppWindow:()=>St,DialogDimension:()=>R,ErrorCode:()=>p,FileOpenPreference:()=>T,FrameContexts:()=>i,HostClientType:()=>c,HostName:()=>L,NotificationTypes:()=>Fe,ParentAppWindow:()=>En,SecondaryM365ContentIdName:()=>I,TaskModuleDimension:()=>Y,TeamType:()=>F,UserSettingTypes:()=>Ae,UserTeamRole:()=>w,ViewerActionTypes:()=>Re,app:()=>Z,appEntity:()=>et,appInitialization:()=>Xe,appInstallDialog:()=>Oe,authentication:()=>ne,barCode:()=>Me,calendar:()=>xe,call:()=>qe,chat:()=>Ne,conversations:()=>ke,dialog:()=>ce,enablePrintCapability:()=>Rn,executeDeepLink:()=>Gn,files:()=>Ze,geoLocation:()=>Le,getContext:()=>kn,getMruTabInstances:()=>Bn,getTabInstances:()=>Vn,initialize:()=>Fn,initializeWithFrameContext:()=>qn,location:()=>De,logs:()=>ye,mail:()=>He,media:()=>de,meeting:()=>Ue,meetingRoom:()=>Je,menus:()=>Ce,monetization:()=>_e,navigateBack:()=>Jn,navigateCrossDomain:()=>Zn,navigateToTab:()=>Yn,notifications:()=>Qe,openFilePreview:()=>_t,pages:()=>x,people:()=>We,print:()=>An,profile:()=>Ve,registerAppButtonClickHandler:()=>Nn,registerAppButtonHoverEnterHandler:()=>Ln,registerAppButtonHoverLeaveHandler:()=>Dn,registerBackButtonHandler:()=>Un,registerBeforeUnloadHandler:()=>xn,registerChangeSettingsHandler:()=>Wn,registerCustomHandler:()=>Dt,registerFocusEnterHandler:()=>Hn,registerFullScreenHandler:()=>Mn,registerOnLoadHandler:()=>_n,registerOnThemeChangeHandler:()=>On,registerUserSettingsChangeHandler:()=>Ut,remoteCamera:()=>$e,returnFocus:()=>Kn,sendCustomEvent:()=>Lt,sendCustomMessage:()=>Nt,setFrameContext:()=>jn,settings:()=>Ke,shareDeepLink:()=>zn,sharing:()=>ze,stageView:()=>Ge,tasks:()=>Ye,teams:()=>tt,teamsCore:()=>ie,uploadCustomApp:()=>Mt,video:()=>Be,webStorage:()=>je});var T,P,I,p,d,c,L,i,F,w,R,z="2.2.0",W="2.0.1",_="2.0.3",K="1.9.0",G="1.8.0",$=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","msft.spoppe.com","*.sharepoint.com","*.sharepoint-df.com","*.sharepointonline.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","*.teams.microsoft.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.office.com"],ee=/^https:\/\//,h=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}();(function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"})(T||(T={})),function(e){e.M365Content="m365content"}(P||(P={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(I||(I={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(p||(p={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(d||(d={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(c||(c={})),function(e){e.office="Office",e.outlook="Outlook",e.orange="Orange",e.teams="Teams"}(L||(L={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(i||(i={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(F||(F={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(w||(w={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(R||(R={}));var se,Y=R;(function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"})(se||(se={}));var ne,m={errorCode:p.NOT_SUPPORTED_ON_PLATFORM},Tt=A(22);function nt(e,o){if(e.substring(0,2)==="*."){var n=e.substring(1);if(o.length>n.length&&o.split(".").length===n.split(".").length&&o.substring(o.length-n.length)===n)return!0}else if(e===o)return!0;return!1}function Et(e){if(e.protocol!=="https:")return!1;var o=e.host;if($.some(function(l){return nt(l,o)}))return!0;for(var n=0,t=h.additionalValidOrigins;n<t.length;n++){var r=t[n];if(nt(r.substring(0,8)==="https://"?r.substring(8):r,o))return!0}return!1}function le(e){return function(o,n){if(!o)throw new Error(e||n)}}function Te(e,o){if(typeof e!="string"||typeof o!="string")return NaN;var n=e.split("."),t=o.split(".");function r(a){return/^\d+$/.test(a)}if(!n.every(r)||!t.every(r))return NaN;for(;n.length<t.length;)n.push("0");for(;t.length<n.length;)t.push("0");for(var l=0;l<n.length;++l)if(Number(n[l])!=Number(t[l]))return Number(n[l])>Number(t[l])?1:-1;return 0}function It(){return Tt.v4()}function ot(e){return Object.keys(e).forEach(function(o){typeof e[o]=="object"&&ot(e[o])}),Object.freeze(e)}function Pt(e,o){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];var r=e.apply(void 0,n);return r.then(function(l){o&&o(void 0,l)}).catch(function(l){o&&o(l)}),r}function rt(e,o){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];var r=e.apply(void 0,n);return r.then(function(){o&&o(null)}).catch(function(l){o&&o(l)}),r}function Ft(e,o){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];var r=e.apply(void 0,n);return r.then(function(l){o&&o(null,l)}).catch(function(l){o&&o(l,null)}),r}function Rt(e,o,n){return new Promise(function(t,r){var l=setTimeout(r,o,n);e().then(function(a){clearTimeout(l),t(a)}).catch(function(a){clearTimeout(l),r(a)})})}function At(e){var o=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&o.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&o.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),o.toString()}function s(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(!h.initializeCalled)throw new Error("The library has not yet been initialized");if(h.frameContext&&e&&e.length>0){for(var n=!1,t=0;t<e.length;t++)if(e[t]===h.frameContext){n=!0;break}if(!n)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(e)+'. Current context: "'+h.frameContext+'".')}}function oe(e){e===void 0&&(e=W);var o=Te(h.clientSupportedSDKVersion,e);return!isNaN(o)&&o>=0}function kt(){return h.hostClientType==c.android||h.hostClientType==c.ios}function he(e){if(e===void 0&&(e=W),!kt())throw{errorCode:p.NOT_SUPPORTED_ON_PLATFORM};if(!oe(e))throw{errorCode:p.OLD_PLATFORM}}function Ot(e){var o=h.additionalValidOrigins.concat(e.filter(function(t){return typeof t=="string"&&ee.test(t)})),n={};o=o.filter(function(t){return!n[t]&&(n[t]=!0,!0)}),h.additionalValidOrigins=o}function Mt(e,o){s(),u("uploadCustomApp",[e],o||le())}function Nt(e,o,n){s(),u(e,o,n)}function Lt(e,o){if(s(),!f.childWindow)throw new Error("The child window has not yet been initialized or is not present");Se(e,o)}function Dt(e,o){var n=this;s(),O(e,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.apply(n,t)})}function Ut(e,o){s(),O("userSettingsChange",o,!0,[e])}function _t(e){s(i.content,i.task),u("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])}(function(e){var o,n,t;function r(S){return new Promise(function(k,V){if(h.hostClientType===c.desktop||h.hostClientType===c.android||h.hostClientType===c.ios||h.hostClientType===c.rigel||h.hostClientType===c.teamsRoomsWindows||h.hostClientType===c.teamsRoomsAndroid||h.hostClientType===c.teamsPhones||h.hostClientType===c.teamsDisplays){var U=document.createElement("a");U.href=S.url,k(ue("authentication.authenticate",[U.href,S.width,S.height,S.isExternal]).then(function(ae){var be=ae[0],bt=ae[1];if(be)return bt;throw new Error(bt)}))}else o={success:k,fail:V},v(S)})}function l(S){return new Promise(function(k){k(ue("authentication.getAuthToken",[S==null?void 0:S.resources,S==null?void 0:S.claims,S==null?void 0:S.silent]))}).then(function(k){var V=k[0],U=k[1];if(V)return U;throw new Error(U)})}function a(){return new Promise(function(S){S(ue("authentication.getUser"))}).then(function(S){var k=S[0],V=S[1];if(k)return V;throw new Error(V)})}function g(){b();try{f.childWindow&&f.childWindow.close()}finally{f.childWindow=null,f.childOrigin=null}}function v(S){g();var k=S.width||600,V=S.height||400;k=Math.min(k,f.currentWindow.outerWidth-400),V=Math.min(V,f.currentWindow.outerHeight-200);var U=document.createElement("a");U.href=S.url.replace("{oauthRedirectMethod}","web");var ae=f.currentWindow.screenLeft!==void 0?f.currentWindow.screenLeft:f.currentWindow.screenX,be=f.currentWindow.screenTop!==void 0?f.currentWindow.screenTop:f.currentWindow.screenY;ae+=f.currentWindow.outerWidth/2-k/2,be+=f.currentWindow.outerHeight/2-V/2,f.childWindow=f.currentWindow.open(U.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+be+", left="+ae+", width="+k+", height="+V),f.childWindow?M():B("FailedToOpenWindow")}function b(){n&&(clearInterval(n),n=0),te("initialize"),te("navigateCrossDomain")}function M(){b(),n=f.currentWindow.setInterval(function(){if(!f.childWindow||f.childWindow.closed)B("CancelledByUser");else{var S=f.childOrigin;try{f.childOrigin="*",Se("ping")}finally{f.childOrigin=S}}},100),O("initialize",function(){return[i.authentication,h.hostClientType]}),O("navigateCrossDomain",function(){return!1})}function N(S){try{o&&o.success(S)}finally{o=null,g()}}function B(S){try{o&&o.fail(new Error(S))}finally{o=null,g()}}function Q(S,k,V){if(S){var U=document.createElement("a");U.href=decodeURIComponent(S),U.host&&U.host!==window.location.host&&U.host==="outlook.office.com"&&U.search.indexOf("client_type=Win32_Outlook")>-1&&(k&&k==="result"&&(V&&(U.href=re(U.href,"result",V)),f.currentWindow.location.assign(re(U.href,"authSuccess",""))),k&&k==="reason"&&(V&&(U.href=re(U.href,"reason",V)),f.currentWindow.location.assign(re(U.href,"authFailure",""))))}}function re(S,k,V){var U=S.indexOf("#"),ae=U===-1?"#":S.substr(U);return ae=ae+"&"+k+(V!==""?"="+V:""),(S=U===-1?S:S.substr(0,U))+ae}e.initialize=function(){O("authentication.authenticate.success",N,!1),O("authentication.authenticate.failure",B,!1)},e.registerAuthenticationHandlers=function(S){t=S},e.authenticate=function(S){var k=S!==void 0,V=k?S:t;if(!V)throw new Error("No parameters are provided for authentication");return s(i.content,i.sidePanel,i.settings,i.remove,i.task,i.stage,i.meetingStage),r(V).then(function(U){try{return V&&V.successCallback?(V.successCallback(U),""):U}finally{k||(t=null)}}).catch(function(U){try{if(V&&V.failureCallback)return V.failureCallback(U.message),"";throw U}finally{k||(t=null)}})},e.getAuthToken=function(S){return s(),l(S).then(function(k){return S&&S.successCallback?(S.successCallback(k),""):k}).catch(function(k){if(S&&S.failureCallback)return S.failureCallback(k.message),"";throw k})},e.getUser=function(S){return s(),a().then(function(k){return S&&S.successCallback?(S.successCallback(k),null):k}).catch(function(k){if(S&&S.failureCallback)return S.failureCallback(k.message),null;throw k})},e.notifySuccess=function(S,k){Q(k,"result",S),s(i.authentication),u("authentication.authenticate.success",[S]),pt(f.parentWindow,function(){return setTimeout(function(){return f.currentWindow.close()},200)})},e.notifyFailure=function(S,k){Q(k,"reason",S),s(i.authentication),u("authentication.authenticate.failure",[S]),pt(f.parentWindow,function(){return setTimeout(function(){return f.currentWindow.close()},200)})}})(ne||(ne={}));var me=function(){return me=Object.assign||function(e){for(var o,n=1,t=arguments.length;n<t;n++)for(var r in o=arguments[n])Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e},me.apply(this,arguments)},E={apiVersion:1,supports:{appInstallDialog:void 0,barCode:void 0,calendar:void 0,call:void 0,chat:void 0,webStorage:void 0,conversations:void 0,dialog:{bot:void 0,update:void 0},geoLocation:{map:void 0},location:void 0,logs:void 0,mail:void 0,meetingRoom:void 0,menus:void 0,monetization:void 0,notifications:void 0,pages:{appButton:void 0,tabs:void 0,config:void 0,backStack:void 0,fullTrust:void 0},people:void 0,permissions:void 0,profile:void 0,remoteCamera:void 0,sharing:void 0,stageView:void 0,teams:{fullTrust:{joinedTeams:void 0}},teamsCore:void 0,video:void 0}},xt={appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{bot:{},update:{}},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},remoteCamera:{},sharing:{},stageView:{},teams:{fullTrust:{}},teamsCore:{},video:{}},it=[c.desktop,c.web,c.android,c.ios,c.rigel,c.surfaceHub,c.teamsRoomsWindows,c.teamsRoomsAndroid,c.teamsPhones,c.teamsDisplays],at={"1.9.0":[{capability:{location:{}},hostClientTypes:it}],"2.0.0":[{capability:{people:{}},hostClientTypes:it}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[c.android,c.teamsRoomsAndroid,c.teamsPhones,c.teamsDisplays]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[c.android,c.ios]}]};function Ht(e){var o=me({},xt);return Object.keys(at).forEach(function(n){Te(e,n)>=0&&at[n].forEach(function(t){t.hostClientTypes.includes(h.hostClientType)&&(o=me(me({},o),t.capability))})}),{apiVersion:1,isLegacyTeams:!0,supports:o}}function Ee(e){E=ot(e)}var ce,Ce,ie,Z,x;function Wt(e){return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:L.teams,clientType:e.hostClientType?e.hostClientType:c.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:h.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:e.userObjectId,displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}(function(e){var o=[];function n(a){h.frameContext&&(h.frameContext===i.task?o.push(a):te("messageForChild"))}function t(){return!!E.supports.dialog}function r(a){return{url:a.url,height:a.size?a.size.height:R.Small,width:a.size?a.size.width:R.Small,title:a.title,fallbackUrl:a.fallbackUrl}}function l(a){return{url:a.url,height:a.size?a.size.height:R.Small,width:a.size?a.size.width:R.Small,title:a.title,fallbackUrl:a.fallbackUrl,completionBotId:a.completionBotId}}e.initialize=function(){O("messageForChild",n,!1)},e.open=function(a,g,v){if(s(i.content,i.sidePanel,i.meetingStage),!t())throw m;v&&O("messageForParent",v),u("tasks.startTask",[r(a)],function(b,M){g==null||g({err:b,result:M}),te("messageForParent")})},e.submit=function(a,g){if(s(i.content,i.sidePanel,i.task,i.meetingStage),!t())throw m;u("tasks.completeTask",[a,g?Array.isArray(g)?g:[g]:[]])},e.sendMessageToParentFromDialog=function(a){if(s(i.task),!t())throw m;u("messageForParent",[a])},e.sendMessageToDialog=function(a){if(s(i.content,i.sidePanel,i.meetingStage),!t())throw m;u("messageForChild",[a])},e.registerOnMessageFromParent=function(a){if(s(i.task),!t())throw m;for(te("messageForChild"),O("messageForChild",a),o.reverse();o.length>0;)a(o.pop())},e.isSupported=t,function(a){function g(){return!!E.supports.dialog&&!!E.supports.dialog.update}a.resize=function(v){if(s(i.content,i.sidePanel,i.task,i.meetingStage),!g())throw m;u("tasks.updateTask",[v])},a.isSupported=g}(e.update||(e.update={})),function(a){function g(){return!!E.supports.dialog&&!!E.supports.dialog.bot}a.open=function(v,b,M){if(s(i.content,i.sidePanel,i.meetingStage),!g())throw m;M&&O("messageForParent",M),u("tasks.startTask",[l(v)],function(N,B){b==null||b({err:N,result:B}),te("messageForParent")})},a.isSupported=g}(e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=r,e.getDialogInfoFromBotUrlDialogInfo=l})(ce||(ce={})),function(e){(function(b){b[b.ifRoom=0]="ifRoom",b[b.overflowOnly=1]="overflowOnly"})(e.DisplayMode||(e.DisplayMode={}));var o,n,t,r=function(){return function(){this.enabled=!0,this.selected=!1}}();function l(b){t&&t(b)||(s(),u("viewConfigItemPress",[b]))}function a(b){o&&o(b)||(s(),u("handleNavBarMenuItemPress",[b]))}function g(b){n&&n(b)||(s(),u("handleActionMenuItemPress",[b]))}function v(){return!!E.supports.menus}e.MenuItem=r,function(b){b.dropDown="dropDown",b.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){O("navBarMenuItemPress",a,!1),O("actionMenuItemPress",g,!1),O("setModuleView",l,!1)},e.setUpViews=function(b,M){if(s(),!v())throw m;t=M,u("setUpViews",[b])},e.setNavBarMenu=function(b,M){if(s(),!v())throw m;o=M,u("setNavBarMenu",[b])},e.showActionMenu=function(b,M){if(s(),!v())throw m;n=M,u("showActionMenu",[b])},e.isSupported=v}(Ce||(Ce={})),function(e){function o(){window.print()}function n(){return!!E.supports.teamsCore}e.enablePrintCapability=function(){if(!h.printCapabilityEnabled){if(s(),!n())throw m;h.printCapabilityEnabled=!0,document.addEventListener("keydown",function(t){(t.ctrlKey||t.metaKey)&&t.keyCode===80&&(o(),t.cancelBubble=!0,t.preventDefault(),t.stopImmediatePropagation())})}},e.print=o,e.registerOnLoadHandler=function(t){if(s(),!n())throw m;Xt(t)},e.registerBeforeUnloadHandler=function(t){if(s(),!n())throw m;Yt(t)},e.isSupported=n}(ie||(ie={})),function(e){e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(t){t.AuthFailed="AuthFailed",t.Timeout="Timeout",t.Other="Other"}(e.FailedReason||(e.FailedReason={})),function(t){t.PermissionError="PermissionError",t.NotFound="NotFound",t.Throttling="Throttling",t.Offline="Offline",t.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return h.initializeCalled},e.getFrameContext=function(){return h.frameContext};function o(t){return new Promise(function(r){h.initializeCalled||(h.initializeCalled=!0,Gt(),h.initializePromise=Jt(t).then(function(l){var a=l.context,g=l.clientType,v=l.runtimeConfig,b=l.clientSupportedSDKVersion,M=b===void 0?W:b;h.frameContext=a,h.hostClientType=g,h.clientSupportedSDKVersion=M;try{if(!(N=JSON.parse(v))||!N.apiVersion)throw new Error("Received runtime config is invalid");v&&Ee(N)}catch(B){if(!(B instanceof SyntaxError))throw B;try{isNaN(Te(v,W))||(h.clientSupportedSDKVersion=v);var N=JSON.parse(M);M&&Ee(N)}catch(Q){if(!(Q instanceof SyntaxError))throw Q;Ee(Ht(h.clientSupportedSDKVersion))}}h.initializeCompleted=!0}),ne.initialize(),Ce.initialize(),x.config.initialize(),ce.initialize()),Array.isArray(t)&&Ot(t),r(h.initializePromise)})}function n(t){s(),jt(t)}e.initialize=function(t){return Rt(function(){return o(t)},5e3,new Error("SDK initialization timed out."))},e._initialize=function(t){f.currentWindow=t},e._uninitialize=function(){h.initializeCalled&&(h.frameContext&&(n(null),x.backStack.registerBackButtonHandler(null),x.registerFullScreenHandler(null),ie.registerBeforeUnloadHandler(null),ie.registerOnLoadHandler(null),ye.registerGetLogHandler(null)),h.frameContext===i.settings&&x.config.registerOnSaveHandler(null),h.frameContext===i.remove&&x.config.registerOnRemoveHandler(null),h.initializeCalled=!1,h.initializeCompleted=!1,h.initializePromise=null,h.additionalValidOrigins=[],h.frameContext=null,h.hostClientType=null,h.isFramelessWindow=!1,Qt())},e.getContext=function(){return new Promise(function(t){s(),t(fe("getContext"))}).then(function(t){return Wt(t)})},e.notifyAppLoaded=function(){s(),u(e.Messages.AppLoaded,[z])},e.notifySuccess=function(){s(),u(e.Messages.Success,[z])},e.notifyFailure=function(t){s(),u(e.Messages.Failure,[t.reason,t.message])},e.notifyExpectedFailure=function(t){s(),u(e.Messages.ExpectedFailure,[t.reason,t.message])},e.registerOnThemeChangeHandler=n,e.openLink=function(t){return new Promise(function(r){s(i.content,i.sidePanel,i.settings,i.task,i.stage,i.meetingStage),r(J("executeDeepLink",t))})}}(Z||(Z={})),function(e){function o(t){if(s(i.content),!n())throw m;u("setFrameContext",[t])}function n(){return!!E.supports.pages}e.returnFocus=function(t){if(s(),!n())throw m;u("returnFocus",[t])},e.registerFocusEnterHandler=function(t){if(s(),!n())throw m;O("focusEnter",t)},e.setCurrentFrame=o,e.initializeWithFrameContext=function(t,r,l){Z.initialize(l).then(function(){return r&&r()}),o(t)},e.getConfig=function(){return new Promise(function(t){if(s(i.content,i.settings,i.remove,i.sidePanel),!n())throw m;t(fe("settings.getSettings"))})},e.navigateCrossDomain=function(t){return new Promise(function(r){if(s(i.content,i.sidePanel,i.settings,i.remove,i.task,i.stage,i.meetingStage),!n())throw m;r(Pe("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))})},e.navigateToApp=function(t){return new Promise(function(r){if(s(i.content,i.sidePanel,i.settings,i.task,i.stage,i.meetingStage),!n())throw m;E.isLegacyTeams?r(J("executeDeepLink",At(t))):r(J("pages.navigateToApp",t))})},e.shareDeepLink=function(t){if(s(i.content,i.sidePanel,i.meetingStage),!n())throw m;u("shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])},e.registerFullScreenHandler=function(t){if(s(),!n())throw m;O("fullScreenChange",t)},e.isSupported=n,function(t){function r(){return!!E.supports.pages&&!!E.supports.pages.tabs}t.navigateToTab=function(l){return new Promise(function(a){if(s(),!r())throw m;a(Pe("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",l))})},t.getTabInstances=function(l){return new Promise(function(a){if(s(),!r())throw m;a(fe("getTabInstances",l))})},t.getMruTabInstances=function(l){return new Promise(function(a){if(s(),!r())throw m;a(fe("getMruTabInstances",l))})},t.isSupported=r}(e.tabs||(e.tabs={})),function(t){var r,l;function a(N){var B=new g(N);r?r(B):B.notifySuccess()}t.initialize=function(){O("settings.save",a,!1),O("settings.remove",v,!1)},t.setValidityState=function(N){if(s(i.settings,i.remove),!M())throw m;u("settings.setValidityState",[N])},t.setConfig=function(N){return new Promise(function(B){if(s(i.content,i.settings,i.sidePanel),!M())throw m;B(J("settings.setSettings",N))})},t.registerOnSaveHandler=function(N){if(s(i.settings),!M())throw m;r=N,N&&u("registerHandler",["save"])},t.registerOnRemoveHandler=function(N){if(s(i.remove,i.settings),!M())throw m;l=N,N&&u("registerHandler",["remove"])},t.registerChangeConfigHandler=function(N){if(s(i.content),!M())throw m;O("changeSettings",N)};var g=function(){function N(B){this.notified=!1,this.result=B||{}}return N.prototype.notifySuccess=function(){this.ensureNotNotified(),u("settings.save.success"),this.notified=!0},N.prototype.notifyFailure=function(B){this.ensureNotNotified(),u("settings.save.failure",[B]),this.notified=!0},N.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},N}();function v(){var N=new b;l?l(N):N.notifySuccess()}var b=function(){function N(){this.notified=!1}return N.prototype.notifySuccess=function(){this.ensureNotNotified(),u("settings.remove.success"),this.notified=!0},N.prototype.notifyFailure=function(B){this.ensureNotNotified(),u("settings.remove.failure",[B]),this.notified=!0},N.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},N}();function M(){return!!E.supports.pages&&!!E.supports.pages.config}t.isSupported=M}(e.config||(e.config={})),function(t){var r;function l(){return new Promise(function(v){if(s(),!g())throw m;v(Pe("navigateBack","Back navigation is not supported in the current client or context."))})}function a(){r&&r()||l()}function g(){return!!E.supports.pages&&!!E.supports.pages.backStack}t._initialize=function(){O("backButtonPress",a,!1)},t.navigateBack=l,t.registerBackButtonHandler=function(v){if(s(),!g())throw m;r=v,v&&u("registerHandler",["backButton"])},t.isSupported=g}(e.backStack||(e.backStack={})),function(t){function r(){return!!E.supports.pages&&!!E.supports.pages.fullTrust}t.enterFullscreen=function(){if(s(i.content),!r())throw m;u("enterFullscreen",[])},t.exitFullscreen=function(){if(s(i.content),!r())throw m;u("exitFullscreen",[])},t.isSupported=r}(e.fullTrust||(e.fullTrust={})),function(t){function r(){return!!E.supports.pages&&!!E.supports.pages.appButton}t.onClick=function(l){if(s(i.content),!r())throw m;O("appButtonClick",l)},t.onHoverEnter=function(l){if(s(i.content),!r())throw m;O("appButtonHoverEnter",l)},t.onHoverLeave=function(l){if(s(i.content),!r())throw m;O("appButtonHoverLeave",l)},t.isSupported=r}(e.appButton||(e.appButton={}))}(x||(x={}));var Vt=(0,A(227).debug)("teamsJs");function st(e){return Vt.extend(e)}var Bt=function(e,o,n){if(n||arguments.length===2)for(var t,r=0,l=o.length;r<l;r++)!t&&r in o||(t||(t=Array.prototype.slice.call(o,0,r)),t[r]=o[r]);return e.concat(t||Array.prototype.slice.call(o))},zt=st("handlers"),j=function(){function e(){}return e.handlers={},e}();function Gt(){j.handlers.themeChange=qt,j.handlers.load=Kt,j.handlers.beforeUnload=Zt,x.backStack._initialize()}var lt=zt.extend("callHandler");function ct(e,o){var n=j.handlers[e];return n?(lt("Invoking the registered handler for message %s with arguments %o",e,o),[!0,n.apply(this,o)]):(lt("Handler for action message %s not found.",e),[!1,void 0])}function O(e,o,n,t){n===void 0&&(n=!0),t===void 0&&(t=[]),o?(j.handlers[e]=o,n&&u("registerHandler",Bt([e],t,!0))):delete j.handlers[e]}function te(e){delete j.handlers[e]}function jt(e){j.themeChangeHandler=e,e&&u("registerHandler",["themeChange"])}function qt(e){j.themeChangeHandler&&j.themeChangeHandler(e),f.childWindow&&Se("themeChange",[e])}function Xt(e){j.loadHandler=e,e&&u("registerHandler",["load"])}function Kt(e){j.loadHandler&&j.loadHandler(e),f.childWindow&&Se("load",[e])}function Yt(e){j.beforeUnloadHandler=e,e&&u("registerHandler",["beforeUnload"])}function Zt(){var e=function(){u("readyToUnload",[])};j.beforeUnloadHandler&&j.beforeUnloadHandler(e)||e()}var ut=function(e,o,n){if(n||arguments.length===2)for(var t,r=0,l=o.length;r<l;r++)!t&&r in o||(t||(t=Array.prototype.slice.call(o,0,r)),t[r]=o[r]);return e.concat(t||Array.prototype.slice.call(o))},Ie=st("communication"),f=function(){return function(){}}(),q=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function Jt(e){if(q.messageListener=function(n){return tn(n)},f.currentWindow=f.currentWindow||window,f.parentWindow=f.currentWindow.parent!==f.currentWindow.self?f.currentWindow.parent:f.currentWindow.opener,(f.parentWindow||e)&&f.currentWindow.addEventListener("message",q.messageListener,!1),!f.parentWindow){var o=f.currentWindow;if(!o.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));h.isFramelessWindow=!0,o.onNativeMessage=ft}try{return f.parentOrigin="*",ue("initialize",[z]).then(function(n){return{context:n[0],clientType:n[1],runtimeConfig:n[2],clientSupportedSDKVersion:n[3]}})}finally{f.parentOrigin=null}}function Qt(){f.currentWindow.removeEventListener("message",q.messageListener,!1),f.parentWindow=null,f.parentOrigin=null,f.childWindow=null,f.childOrigin=null,q.parentMessageQueue=[],q.childMessageQueue=[],q.nextMessageId=0,q.callbacks={}}function fe(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return ue(e,o).then(function(t){return t[0]})}function J(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return ue(e,o).then(function(t){var r=t[0],l=t[1];if(!r)throw new Error(l)})}function Pe(e,o){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];return ue(e,n).then(function(r){var l=r[0],a=r[1];if(!l)throw new Error(a||o)})}function X(e){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return ue(e,o).then(function(t){var r=t[0],l=t[1];if(r)throw r;return l})}function ue(e,o){return o===void 0&&(o=void 0),new Promise(function(n){n($t(dt(e,o).id))})}function $t(e){return new Promise(function(o){q.promiseCallbacks[e]=o})}function u(e,o,n){var t;o instanceof Function?n=o:o instanceof Array&&(t=o);var r=dt(e,t);n&&(q.callbacks[r.id]=n)}var en=Ie.extend("sendMessageToParentHelper");function dt(e,o){var n=en,t=f.parentWindow,r=cn(e,o);if(n("Message %i information: %o",r.id,{actionName:e,args:o}),h.isFramelessWindow)f.currentWindow&&f.currentWindow.nativeInterface&&(n("Sending message %i to parent via framelessPostMessage interface",r.id),f.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(r)));else{var l=we(t);t&&l?(n("Sending message %i to parent via postMessage",r.id),t.postMessage(r,l)):(n("Adding message %i to parent message queue",r.id),ve(t).push(r))}return r}function tn(e){if(e&&e.data&&typeof e.data=="object"){var o=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;nn(o,n)&&(on(o,n),o===f.parentWindow?ft(e):o===f.childWindow&&sn(e))}}function nn(e,o){return(!f.currentWindow||e!==f.currentWindow)&&(!!(f.currentWindow&&f.currentWindow.location&&o&&o===f.currentWindow.location.origin)||Et(new URL(o)))}function on(e,o){h.isFramelessWindow||f.parentWindow&&!f.parentWindow.closed&&e!==f.parentWindow?f.childWindow&&!f.childWindow.closed&&e!==f.childWindow||(f.childWindow=e,f.childOrigin=o):(f.parentWindow=e,f.parentOrigin=o),f.parentWindow&&f.parentWindow.closed&&(f.parentWindow=null,f.parentOrigin=null),f.childWindow&&f.childWindow.closed&&(f.childWindow=null,f.childOrigin=null),gt(f.parentWindow),gt(f.childWindow)}var rn=Ie.extend("handleParentMessage");function ft(e){var o=rn;if("id"in e.data&&typeof e.data.id=="number"){var n=e.data,t=q.callbacks[n.id];o("Received a response from parent for message %i",n.id),t&&(o("Invoking the registered callback for message %i with arguments %o",n.id,n.args),t.apply(null,ut(ut([],n.args,!0),[n.isPartialResponse],!1)),an(e)||(o("Removing registered callback for message %i",n.id),delete q.callbacks[n.id]));var r=q.promiseCallbacks[n.id];r&&(o("Invoking the registered promise callback for message %i with arguments %o",n.id,n.args),r(n.args),o("Removing registered promise callback for message %i",n.id),delete q.promiseCallbacks[n.id])}else"func"in e.data&&typeof e.data.func=="string"?(o("Received an action message %s from parent",(n=e.data).func),ct(n.func,n.args)):o("Received an unknown message: %O",e)}function an(e){return e.data.isPartialResponse===!0}function sn(e){if("id"in e.data&&"func"in e.data){var o=e.data,n=ct(o.func,o.args),t=n[0],r=n[1];t&&r!==void 0?mt(o.id,Array.isArray(r)?r:[r]):u(o.func,o.args,function(){for(var l=[],a=0;a<arguments.length;a++)l[a]=arguments[a];if(f.childWindow){var g=l.pop();mt(o.id,l,g)}})}}function ve(e){return e===f.parentWindow?q.parentMessageQueue:e===f.childWindow?q.childMessageQueue:[]}function we(e){return e===f.parentWindow?f.parentOrigin:e===f.childWindow?f.childOrigin:null}var ye,Fe,Re,Ae,ke,ln=Ie.extend("flushMessageQueue");function gt(e){for(var o=we(e),n=ve(e),t=e==f.parentWindow?"parent":"child";e&&o&&n.length>0;){var r=n.shift();ln("Flushing message %i from "+t+" message queue via postMessage.",r.id),e.postMessage(r,o)}}function pt(e,o){var n=f.currentWindow.setInterval(function(){ve(e).length===0&&(clearInterval(n),o())},100)}function mt(e,o,n){var t=f.childWindow,r=un(e,o,n),l=we(t);t&&l&&t.postMessage(r,l)}function Se(e,o){var n=f.childWindow,t=dn(e,o),r=we(n);n&&r?n.postMessage(t,r):ve(n).push(t)}function cn(e,o){return{id:q.nextMessageId++,func:e,timestamp:Date.now(),args:o||[]}}function un(e,o,n){return{id:e,args:o||[],isPartialResponse:n}}function dn(e,o){return{func:e,args:o||[]}}(function(e){function o(){return!!E.supports.logs}e.registerGetLogHandler=function(n){if(s(),!o())throw m;n?O("log.request",function(){u("log.receive",[n()])}):te("log.request")},e.isSupported=o})(ye||(ye={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Fe||(Fe={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Re||(Re={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Ae||(Ae={})),function(e){function o(){return!!E.supports.conversations}e.openConversation=function(n){return new Promise(function(t){if(s(i.content),!o())throw m;var r=J("conversations.openConversation",{title:n.title,subEntityId:n.subEntityId,conversationId:n.conversationId,channelId:n.channelId,entityId:n.entityId});n.onStartConversation&&O("startConversation",function(l,a,g,v){return n.onStartConversation({subEntityId:l,conversationId:a,channelId:g,entityId:v})}),n.onCloseConversation&&O("closeConversation",function(l,a,g,v){return n.onCloseConversation({subEntityId:l,conversationId:a,channelId:g,entityId:v})}),t(r)})},e.closeConversation=function(){if(s(i.content),!o())throw m;u("conversations.closeConversation"),te("startConversation"),te("closeConversation")},e.getChatMembers=function(){return new Promise(function(n){if(s(),!o())throw m;n(fe("getChatMembers"))})},e.isSupported=o}(ke||(ke={}));var Oe;function ht(e,o,n){if(e.length===0)throw new Error("Must have at least one user when creating a chat deep link");return"https://teams.microsoft.com/l/chat/0/0?"+("users="+e.map(function(t){return encodeURIComponent(t)}).join(","))+(o===void 0?"":"&topicName="+encodeURIComponent(o))+(n===void 0?"":"&message="+encodeURIComponent(n))}function fn(e,o,n){if(e.length===0)throw new Error("Must have at least one target when creating a call deep link");return"https://teams.microsoft.com/l/call/0/0?"+("users="+e.map(function(t){return encodeURIComponent(t)}).join(","))+(o===void 0?"":"&withVideo="+encodeURIComponent(o))+(n===void 0?"":"&source="+encodeURIComponent(n))}function gn(e,o,n,t,r){return"https://teams.microsoft.com/l/meeting/new?"+(e===void 0?"":"attendees="+e.map(function(l){return encodeURIComponent(l)}).join(","))+(o===void 0?"":"&startTime="+encodeURIComponent(o))+(n===void 0?"":"&endTime="+encodeURIComponent(n))+(t===void 0?"":"&subject="+encodeURIComponent(t))+(r===void 0?"":"&content="+encodeURIComponent(r))}function pn(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return"https://teams.microsoft.com/l/app/"+encodeURIComponent(e)}(function(e){function o(){return!!E.supports.appInstallDialog}e.openAppInstallDialog=function(n){return new Promise(function(t){if(s(i.content,i.sidePanel,i.settings,i.task,i.stage,i.meetingStage),!o())throw new Error("Not supported");E.isLegacyTeams?t(J("executeDeepLink",pn(n.appId))):(u("appInstallDialog.openAppInstallDialog",[n]),t())})},e.isSupported=o})(Oe||(Oe={}));var de,Me,Ne,Le,Ct=function(){var e=function(o,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])},e(o,n)};return function(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=o}e(o,n),o.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();function vt(e,o){if(e==null||o==null||e.length<=0)return null;var n,t=1;return e.sort(function(r,l){return r.sequence>l.sequence?1:-1}),e.forEach(function(r){r.sequence==t&&(n=n?new Blob([n,r.file],{type:o}):new Blob([r.file],{type:o}),t++)}),n}function wt(e,o){if(e==null||o==null)return null;for(var n=atob(e.chunk),t=new Array(n.length),r=0;r<n.length;r++)t[r]=n.charCodeAt(r);var l=new Uint8Array(t),a=new Blob([l],{type:o});return{sequence:e.chunkSequence,file:a}}function mn(e){wn(e)?he("2.0.2"):yn(e)?he(_):vn(e)&&he("2.0.4")}function hn(e){return!(e.mediaType!=de.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function Cn(e){return!(e==null||e.maxMediaCount>10)}function vn(e){var o;return!((e==null?void 0:e.mediaType)!=de.MediaType.Image||!(!((o=e==null?void 0:e.imageProps)===null||o===void 0)&&o.imageOutputFormats))}function wn(e){return!(!e||e.mediaType!=de.MediaType.VideoAndImage&&!e.videoAndImageProps)}function yn(e){return!(!e||e.mediaType!=de.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Sn(e,o,n){return e!=null&&o!=null&&o==de.FileFormat.ID&&n!=null}function bn(e){return!(e==null||e.length<=0||e.length>10)}function yt(e){return!e||!(e.timeOutIntervalInSec===null||e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec>60)}function Tn(e){return!(e&&(e.title&&typeof e.title!="string"||e.setSelected&&typeof e.setSelected!="object"||e.openOrgWideSearchInChatOrChannel&&typeof e.openOrgWideSearchInChatOrChannel!="boolean"||e.singleSelect&&typeof e.singleSelect!="boolean"))}(function(e){(function(a){a.Base64="base64",a.ID="id"})(e.FileFormat||(e.FileFormat={}));var o=function(){return function(){}}();e.File=o,e.captureImage=function(a){if(!a)throw new Error("[captureImage] Callback cannot be null");s(i.content,i.task),h.isFramelessWindow?oe("1.7.0")?u("captureImage",a):a({errorCode:p.OLD_PLATFORM},void 0):a({errorCode:p.NOT_SUPPORTED_ON_PLATFORM},void 0)};var n=function(a){function g(v){v===void 0&&(v=null);var b=a.call(this)||this;return v&&(b.content=v.content,b.format=v.format,b.mimeType=v.mimeType,b.name=v.name,b.preview=v.preview,b.size=v.size),b}return Ct(g,a),g.prototype.getMedia=function(v){if(!v)throw new Error("[get Media] Callback cannot be null");s(i.content,i.task),oe(G)?Sn(this.mimeType,this.format,this.content)?oe("2.0.0")?this.getMediaViaCallback(v):this.getMediaViaHandler(v):v({errorCode:p.INVALID_ARGUMENTS},null):v({errorCode:p.OLD_PLATFORM},null)},g.prototype.getMediaViaCallback=function(v){var b={mediaMimeType:this.mimeType,assembleAttachment:[]};u("getMedia",[this.content],function(M){if(v)if(M&&M.error)v(M.error,null);else if(M&&M.mediaChunk)if(M.mediaChunk.chunkSequence<=0){var N=vt(b.assembleAttachment,b.mediaMimeType);v(M.error,N)}else{var B=wt(M.mediaChunk,b.mediaMimeType);b.assembleAttachment.push(B)}else v({errorCode:p.INTERNAL_ERROR,message:"data received is null"},null)})},g.prototype.getMediaViaHandler=function(v){var b=It(),M={mediaMimeType:this.mimeType,assembleAttachment:[]},N=[b,this.content];this.content&&v&&u("getMedia",N),O("getMedia"+b,function(B){if(v){var Q=JSON.parse(B);if(Q.error)v(Q.error,null),te("getMedia"+b);else if(Q.mediaChunk)if(Q.mediaChunk.chunkSequence<=0){var re=vt(M.assembleAttachment,M.mediaMimeType);v(Q.error,re),te("getMedia"+b)}else{var S=wt(Q.mediaChunk,M.mediaMimeType);M.assembleAttachment.push(S)}else v({errorCode:p.INTERNAL_ERROR,message:"data received is null"},null),te("getMedia"+b)}})},g}(o);e.Media=n;var t,r,l=function(a){function g(){return a!==null&&a.apply(this,arguments)||this}return Ct(g,a),g.prototype.getMediaType=function(){return r.Video},g.prototype.notifyEventToApp=function(v){if(this.controllerCallback)switch(v){case t.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},g}(function(){function a(g){this.controllerCallback=g}return a.prototype.notifyEventToHost=function(g,v){s(i.content,i.task);try{he(_)}catch(b){return void(v&&v(b))}u("media.controller",[{mediaType:this.getMediaType(),mediaControllerEvent:g}],function(b){v&&v(b)})},a.prototype.stop=function(g){this.notifyEventToHost(t.StopRecording,g)},a}());e.VideoController=l,function(a){a[a.StartRecording=1]="StartRecording",a[a.StopRecording=2]="StopRecording"}(t=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(a){a[a.Photo=1]="Photo",a[a.Document=2]="Document",a[a.Whiteboard=3]="Whiteboard",a[a.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(a){a[a.Camera=1]="Camera",a[a.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(a){a[a.Image=1]="Image",a[a.Video=2]="Video",a[a.VideoAndImage=3]="VideoAndImage",a[a.Audio=4]="Audio"}(r=e.MediaType||(e.MediaType={})),function(a){a[a.ID=1]="ID",a[a.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(a){a[a.IMAGE=1]="IMAGE",a[a.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(a,g){if(!g)throw new Error("[select Media] Callback cannot be null");if(s(i.content,i.task),oe(G)){try{mn(a)}catch(M){return void g(M,null)}if(Cn(a))u("selectMedia",[a],function(M,N,B){if(B)hn(a)&&a.videoProps.videoController.notifyEventToApp(B);else if(N){for(var Q=[],re=0,S=N;re<S.length;re++){var k=S[re];Q.push(new n(k))}g(M,Q)}else g(M,null)});else{var v={errorCode:p.INVALID_ARGUMENTS};g(v,null)}}else{var b={errorCode:p.OLD_PLATFORM};g(b,null)}},e.viewImages=function(a,g){if(!g)throw new Error("[view images] Callback cannot be null");s(i.content,i.task),oe(G)?bn(a)?u("viewImages",[a],g):g({errorCode:p.INVALID_ARGUMENTS}):g({errorCode:p.OLD_PLATFORM})},e.scanBarCode=function(a,g){if(!a)throw new Error("[media.scanBarCode] Callback cannot be null");s(i.content,i.task),h.hostClientType!==c.desktop&&h.hostClientType!==c.web&&h.hostClientType!==c.rigel&&h.hostClientType!==c.teamsRoomsWindows&&h.hostClientType!==c.teamsRoomsAndroid&&h.hostClientType!==c.teamsPhones&&h.hostClientType!==c.teamsDisplays?oe("1.9.0")?yt(g)?u("media.scanBarCode",[g],a):a({errorCode:p.INVALID_ARGUMENTS},null):a({errorCode:p.OLD_PLATFORM},null):a({errorCode:p.NOT_SUPPORTED_ON_PLATFORM},null)}})(de||(de={})),function(e){function o(){return!(!E.supports.barCode||!E.supports.permissions)}e.scanBarCode=function(n){return new Promise(function(t){if(s(i.content,i.task),!o())throw m;if(!yt(n))throw{errorCode:p.INVALID_ARGUMENTS};t(X("media.scanBarCode",n))})},e.hasPermission=function(){if(s(i.content,i.task),!o())throw m;var n=d.Media;return new Promise(function(t){t(X("permissions.has",n))})},e.requestPermission=function(){if(s(i.content,i.task),!o())throw m;var n=d.Media;return new Promise(function(t){t(X("permissions.request",n))})},e.isSupported=o}(Me||(Me={})),function(e){function o(t){return new Promise(function(r){if(s(i.content,i.task),!n())throw m;E.isLegacyTeams?r(J("executeDeepLink",ht([t.user],void 0,t.message))):r(J("chat.openChat",{members:t.user,message:t.message}))})}function n(){return!!E.supports.chat}e.openChat=o,e.openGroupChat=function(t){return new Promise(function(r){if(t.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(t.users.length===1)o({user:t.users[0],message:t.message});else{if(s(i.content,i.task),!n())throw m;E.isLegacyTeams?r(J("executeDeepLink",ht(t.users,t.topic,t.message))):r(J("chat.openChat",{members:t.users,message:t.message,topic:t.topic}))}})},e.isSupported=n}(Ne||(Ne={})),function(e){function o(){return!(!E.supports.geoLocation||!E.supports.permissions)}e.getCurrentLocation=function(){if(s(i.content,i.task),!o())throw m;return X("location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(s(i.content,i.task),!o())throw m;var n=d.GeoLocation;return new Promise(function(t){t(X("permissions.has",n))})},e.requestPermission=function(){if(s(i.content,i.task),!o())throw m;var n=d.GeoLocation;return new Promise(function(t){t(X("permissions.request",n))})},e.isSupported=o,function(n){function t(){return!!(E.supports.geoLocation&&E.supports.geoLocation.map&&E.supports.permissions)}n.chooseLocation=function(){if(s(i.content,i.task),!t())throw m;return X("location.getLocation",{allowChooseLocation:!0,showMap:!0})},n.showLocation=function(r){if(s(i.content,i.task),!t())throw m;if(!r)throw{errorCode:p.INVALID_ARGUMENTS};return X("location.showLocation",r)},n.isSupported=t}(e.map||(e.map={}))}(Le||(Le={}));var De,Ue,_e,xe,He,We,Ve,Be,ze,Ge,je,qe,Xe,Ke,St=function(){function e(){}return e.prototype.postMessage=function(o,n){s(),u("messageForChild",[o],n||le())},e.prototype.addEventListener=function(o,n){s(),o==="message"&&O("messageForParent",n)},e}(),En=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(o,n){s(i.task),u("messageForParent",[o],n||le())},e.prototype.addEventListener=function(o,n){s(i.task),o==="message"&&O("messageForChild",n)},e}();function In(e){return e?e.modality&&typeof e.modality!="string"?[!1,"modality must be a string"]:e.targetElementBoundingRect&&typeof e.targetElementBoundingRect=="object"?e.triggerType&&typeof e.triggerType=="string"?Pn(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function Pn(e){return e?e.displayName&&typeof e.displayName!="string"?[!1,"displayName must be a string"]:e.identifiers&&typeof e.identifiers=="object"?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&typeof e.identifiers.AadObjectId!="string"?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&typeof e.identifiers.Smtp!="string"?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&typeof e.identifiers.Upn!="string"?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}function Fn(e,o){Z.initialize(o).then(function(){e&&e()})}function Rn(){ie.enablePrintCapability()}function An(){ie.print()}function kn(e){s(),Z.getContext().then(function(o){e&&e(Xn(o))})}function On(e){Z.registerOnThemeChangeHandler(e)}function Mn(e){x.registerFullScreenHandler(e)}function Nn(e){x.appButton.onClick(e)}function Ln(e){x.appButton.onHoverEnter(e)}function Dn(e){x.appButton.onHoverLeave(e)}function Un(e){x.backStack.registerBackButtonHandler(e)}function _n(e){ie.registerOnLoadHandler(e)}function xn(e){ie.registerBeforeUnloadHandler(e)}function Hn(e){x.registerFocusEnterHandler(e)}function Wn(e){x.config.registerChangeConfigHandler(e)}function Vn(e,o){s(),x.tabs.getTabInstances(o).then(function(n){e(n)})}function Bn(e,o){s(),x.tabs.getMruTabInstances(o).then(function(n){e(n)})}function zn(e){x.shareDeepLink({subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function Gn(e,o){s(i.content,i.sidePanel,i.settings,i.task,i.stage,i.meetingStage),o=o||le(),Z.openLink(e).then(function(){o(!0)}).catch(function(n){o(!1,n.message)})}function jn(e){x.setCurrentFrame(e)}function qn(e,o,n){x.initializeWithFrameContext(e,o,n)}function Xn(e){return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId,theme:e.app.theme,appIconPosition:e.app.iconPositionVertical,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId,userClickTime:e.app.userClickTime,userFileOpenPreference:e.app.userFileOpenPreference,appLaunchId:e.app.appLaunchId,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId,ringId:e.app.host.ringId,entityId:e.page.id,frameContext:e.page.frameContext,subEntityId:e.page.subPageId,isFullScreen:e.page.isFullScreen,isMultiWindow:e.page.isMultiWindow,sourceOrigin:e.page.sourceOrigin,userObjectId:e.user!==void 0?e.user.id:void 0,isCallingAllowed:e.user!==void 0?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:e.user!==void 0?e.user.isPSTNCallingAllowed:void 0,userLicenseType:e.user!==void 0?e.user.licenseType:void 0,loginHint:e.user!==void 0?e.user.loginHint:void 0,userPrincipalName:e.user!==void 0?e.user.userPrincipalName:void 0,tid:e.user!==void 0&&e.user.tenant!==void 0?e.user.tenant.id:void 0,tenantSKU:e.user!==void 0&&e.user.tenant!==void 0?e.user.tenant.teamsSku:void 0,channelId:e.channel!==void 0?e.channel.id:void 0,channelName:e.channel!==void 0?e.channel.displayName:void 0,channelRelativeUrl:e.channel!==void 0?e.channel.relativeUrl:void 0,channelType:e.channel!==void 0?e.channel.membershipType:void 0,defaultOneNoteSectionId:e.channel!==void 0?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:e.channel!==void 0?e.channel.ownerGroupId:void 0,hostTeamTenantId:e.channel!==void 0?e.channel.ownerTenantId:void 0,chatId:e.chat!==void 0?e.chat.id:void 0,meetingId:e.meeting!==void 0?e.meeting.id:void 0,sharepoint:e.sharepoint,teamId:e.team!==void 0?e.team.internalId:void 0,teamName:e.team!==void 0?e.team.displayName:void 0,teamType:e.team!==void 0?e.team.type:void 0,groupId:e.team!==void 0?e.team.groupId:void 0,teamTemplateId:e.team!==void 0?e.team.templateId:void 0,isTeamArchived:e.team!==void 0?e.team.isArchived:void 0,userTeamRole:e.team!==void 0?e.team.userRole:void 0,teamSiteUrl:e.sharePointSite!==void 0?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:e.sharePointSite!==void 0?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:e.sharePointSite!==void 0?e.sharePointSite.teamSitePath:void 0,teamSiteId:e.sharePointSite!==void 0?e.sharePointSite.teamSiteId:void 0,mySitePath:e.sharePointSite!==void 0?e.sharePointSite.mySitePath:void 0,mySiteDomain:e.sharePointSite!==void 0?e.sharePointSite.mySiteDomain:void 0}}function Kn(e){x.returnFocus(e)}function Yn(e,o){s(),o=o||le(),x.tabs.navigateToTab(e).then(function(){o(!0)}).catch(function(n){o(!1,n.message)})}function Zn(e,o){s(i.content,i.sidePanel,i.settings,i.remove,i.task,i.stage,i.meetingStage),o=o||le(),x.navigateCrossDomain(e).then(function(){o(!0)}).catch(function(n){o(!1,n.message)})}function Jn(e){s(),e=e||le(),x.backStack.navigateBack().then(function(){e(!0)}).catch(function(o){e(!1,o.message)})}(function(e){function o(){return!!E.supports.location}e.getLocation=function(n,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(s(i.content,i.task),!oe(K))throw{errorCode:p.OLD_PLATFORM};if(!n)throw{errorCode:p.INVALID_ARGUMENTS};if(!o())throw m;u("location.getLocation",[n],t)},e.showLocation=function(n,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(s(i.content,i.task),!oe(K))throw{errorCode:p.OLD_PLATFORM};if(!n)throw{errorCode:p.INVALID_ARGUMENTS};if(!o())throw m;u("location.showLocation",[n],t)},e.isSupported=o})(De||(De={})),function(e){(function(o){o.like="like",o.heart="heart",o.laugh="laugh",o.surprised="surprised",o.applause="applause"})(e.MeetingReactionType||(e.MeetingReactionType={})),function(o){o.Unknown="Unknown",o.Adhoc="Adhoc",o.Scheduled="Scheduled",o.Recurring="Recurring",o.Broadcast="Broadcast",o.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(o){o.OneOnOneCall="oneOnOneCall",o.GroupCall="groupCall"}(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(o){if(!o)throw new Error("[get incoming client audio state] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("getIncomingClientAudioState",o)},e.toggleIncomingClientAudio=function(o){if(!o)throw new Error("[toggle incoming client audio] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("toggleIncomingClientAudio",o)},e.getMeetingDetails=function(o){if(!o)throw new Error("[get meeting details] Callback cannot be null");s(i.sidePanel,i.meetingStage,i.settings,i.content),u("meeting.getMeetingDetails",o)},e.getAuthenticationTokenForAnonymousUser=function(o){if(!o)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("meeting.getAuthenticationTokenForAnonymousUser",o)},e.getLiveStreamState=function(o){if(!o)throw new Error("[get live stream state] Callback cannot be null");s(i.sidePanel),u("meeting.getLiveStreamState",o)},e.requestStartLiveStreaming=function(o,n,t){if(!o)throw new Error("[request start live streaming] Callback cannot be null");s(i.sidePanel),u("meeting.requestStartLiveStreaming",[n,t],o)},e.requestStopLiveStreaming=function(o){if(!o)throw new Error("[request stop live streaming] Callback cannot be null");s(i.sidePanel),u("meeting.requestStopLiveStreaming",o)},e.registerLiveStreamChangedHandler=function(o){if(!o)throw new Error("[register live stream changed handler] Handler cannot be null");s(i.sidePanel),O("meeting.liveStreamChanged",o)},e.shareAppContentToStage=function(o,n){if(!o)throw new Error("[share app content to stage] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("meeting.shareAppContentToStage",[n],o)},e.getAppContentStageSharingCapabilities=function(o){if(!o)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("meeting.getAppContentStageSharingCapabilities",o)},e.stopSharingAppContentToStage=function(o){if(!o)throw new Error("[stop sharing app content to stage] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("meeting.stopSharingAppContentToStage",o)},e.getAppContentStageSharingState=function(o){if(!o)throw new Error("[get app content stage sharing state] Callback cannot be null");s(i.sidePanel,i.meetingStage),u("meeting.getAppContentStageSharingState",o)},e.registerSpeakingStateChangeHandler=function(o){if(!o)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");s(i.sidePanel,i.meetingStage),O("meeting.speakingStateChanged",o)},e.registerRaiseHandStateChangedHandler=function(o){if(!o)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");s(i.sidePanel,i.meetingStage),O("meeting.raiseHandStateChanged",o)},e.registerMeetingReactionReceivedHandler=function(o){if(!o)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");s(i.sidePanel,i.meetingStage),O("meeting.meetingReactionReceived",o)}}(Ue||(Ue={})),function(e){function o(){return!!E.supports.monetization}e.openPurchaseExperience=function(n,t){var r,l;return typeof n=="function"?(r=n,l=t):l=n,s(i.content),Ft(function(){return new Promise(function(a){if(!o())throw m;a(X("monetization.openPurchaseExperience",l))})},r)},e.isSupported=o}(_e||(_e={})),function(e){function o(){return!!E.supports.calendar}e.openCalendarItem=function(n){return new Promise(function(t){if(s(i.content),!o())throw new Error("Not supported");if(!n.itemId||!n.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(J("calendar.openCalendarItem",n))})},e.composeMeeting=function(n){return new Promise(function(t){if(s(i.content),!o())throw new Error("Not supported");E.isLegacyTeams?t(J("executeDeepLink",gn(n.attendees,n.startTime,n.endTime,n.subject,n.content))):t(J("calendar.composeMeeting",n))})},e.isSupported=o}(xe||(xe={})),function(e){function o(){return!!E.supports.mail}e.openMailItem=function(n){return new Promise(function(t){if(s(i.content),!o())throw new Error("Not supported");if(!n.itemId||!n.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(J("mail.openMailItem",n))})},e.composeMail=function(n){return new Promise(function(t){if(s(i.content),!o())throw new Error("Not supported");t(J("mail.composeMail",n))})},e.isSupported=o,function(n){n.New="new",n.Reply="reply",n.ReplyAll="replyAll",n.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(He||(He={})),function(e){function o(t){return new Promise(function(r){if(!oe("2.0.0"))throw{errorCode:p.OLD_PLATFORM};if(!Tn(t))throw{errorCode:p.INVALID_ARGUMENTS};if(!n())throw m;r(X("people.selectPeople",t))})}function n(){return!!E.supports.people}e.selectPeople=function(t,r){var l,a,g;return s(i.content,i.task,i.settings),typeof t=="function"?(a=(l=[t,r])[0],g=l[1]):g=t,Pt(o,a,g)},e.isSupported=n}(We||(We={})),function(e){e.showProfile=function(o){return s(i.content),new Promise(function(n){var t=In(o),r=t[0],l=t[1];if(!r)throw{errorCode:p.INVALID_ARGUMENTS,message:l};n(X("profile.showProfile",{modality:o.modality,persona:o.persona,triggerType:o.triggerType,targetRectangle:{x:o.targetElementBoundingRect.x,y:o.targetElementBoundingRect.y,width:o.targetElementBoundingRect.width,height:o.targetElementBoundingRect.height}}))})},e.isSupported=function(){return!!E.supports.profile}}(Ve||(Ve={})),function(e){function o(){u("video.videoFrameProcessed")}function n(r){u("video.notifyError",[r])}function t(){return!!E.supports.video}(function(r){r[r.NV12=0]="NV12"})(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(r){r[r.EffectChanged=0]="EffectChanged",r[r.EffectDisabled=1]="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(r,l){if(s(i.sidePanel),!t())throw m;O("video.newVideoFrame",function(a){a!==void 0&&r(a,o,n)}),u("video.registerForVideoFrame",[l])},e.notifySelectedVideoEffectChanged=function(r,l){if(s(i.sidePanel),!t())throw m;u("video.videoEffectChanged",[r,l])},e.registerForVideoEffect=function(r){if(s(i.sidePanel),!t())throw m;O("video.effectParameterChange",r)},e.isSupported=t}(Be||(Be={})),function(e){function o(a){return new Promise(function(g){if(!l())throw m;g(X(e.SharingAPIMessages.shareWebContent,a))})}function n(a){if(!(a&&a.content&&a.content.length))throw{errorCode:p.INVALID_ARGUMENTS,message:"Shared content is missing"}}function t(a){if(a.content.some(function(g){return!g.type}))throw{errorCode:p.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(a.content.some(function(g){return g.type!==a.content[0].type}))throw{errorCode:p.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}function r(a){if(a.content[0].type!=="URL")throw{errorCode:p.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(a.content.some(function(g){return!g.url}))throw{errorCode:p.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}function l(){return!!E.supports.sharing}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(a,g){try{n(a),t(a),r(a)}catch(v){return rt(function(){return Promise.reject(v)},g)}return s(i.content,i.sidePanel,i.task,i.stage,i.meetingStage),rt(o,g,a)},e.isSupported=l}(ze||(ze={})),function(e){function o(){return!!E.supports.stageView}e.open=function(n){return new Promise(function(t){if(s(i.content),!o())throw m;if(!n)throw new Error("[stageView.open] Stage view params cannot be null");t(X("stageView.open",n))})},e.isSupported=o}(Ge||(Ge={})),function(e){function o(){return!!E.supports.webStorage}e.isWebStorageClearedOnUserLogOut=function(){return s(),h.hostClientType===c.desktop||o()},e.isSupported=o}(je||(je={})),function(e){var o;function n(){return!!E.supports.call}(function(t){t.Unknown="unknown",t.Audio="audio",t.Video="video",t.VideoBasedScreenSharing="videoBasedScreenSharing",t.Data="data"})(o=e.CallModalities||(e.CallModalities={})),e.startCall=function(t){return new Promise(function(r){var l;if(s(i.content,i.task),!n())throw m;if(!E.isLegacyTeams)return u("call.startCall",[t],r);r(X("executeDeepLink",fn(t.targets,(l=t.requestedModalities)===null||l===void 0?void 0:l.includes(o.Video),t.source)))})},e.isSupported=n}(qe||(qe={})),function(e){e.Messages=Z.Messages,e.FailedReason=Z.FailedReason,e.ExpectedFailureReason=Z.ExpectedFailureReason,e.notifyAppLoaded=function(){Z.notifyAppLoaded()},e.notifySuccess=function(){Z.notifySuccess()},e.notifyFailure=function(o){Z.notifyFailure(o)},e.notifyExpectedFailure=function(o){Z.notifyExpectedFailure(o)}}(Xe||(Xe={})),function(e){e.setValidityState=function(o){x.config.setValidityState(o)},e.getSettings=function(o){s(i.content,i.settings,i.remove,i.sidePanel),x.getConfig().then(function(n){o(n)})},e.setSettings=function(o,n){s(i.content,i.settings,i.sidePanel),n=n||le(),x.config.setConfig(o).then(function(){n(!0)}).catch(function(t){n(!1,t.message)})},e.registerOnSaveHandler=function(o){x.config.registerOnSaveHandler(o)},e.registerOnRemoveHandler=function(o){x.config.registerOnRemoveHandler(o)}}(Ke||(Ke={}));var Ye,Ze,Je,Qe,$e,et,tt,Qn=function(e,o){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&o.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(t=Object.getOwnPropertySymbols(e);r<t.length;r++)o.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(n[t[r]]=e[t[r]])}return n};(function(e){function o(r){return{url:r.url,size:{height:r.height?r.height:Y.Small,width:r.width?r.width:Y.Small},title:r.title,fallbackUrl:r.fallbackUrl}}function n(r){return{url:r.url,size:{height:r.height?r.height:Y.Small,width:r.width?r.width:Y.Small},title:r.title,fallbackUrl:r.fallbackUrl,completionBotId:r.completionBotId}}function t(r){return r.height=r.height?r.height:Y.Small,r.width=r.width?r.width:Y.Small,r}e.startTask=function(r,l){var a=l?function(g){return l(g.err,g.result)}:void 0;return r.card!==void 0||r.url===void 0?(s(i.content,i.sidePanel,i.meetingStage),u("tasks.startTask",[r],l)):r.completionBotId!==void 0?ce.bot.open(n(r),a):ce.open(o(r),a),new St},e.updateTask=function(r){(r=t(r)).width,r.height;var l=Qn(r,["width","height"]);if(Object.keys(l).length)throw new Error("resize requires a TaskInfo argument containing only width and height");ce.update.resize(r)},e.submitTask=function(r,l){ce.submit(r,l)},e.getUrlDialogInfoFromTaskInfo=o,e.getBotUrlDialogInfoFromTaskInfo=n,e.getDefaultSizeIfNotProvided=t})(Ye||(Ye={})),function(e){var o;function n(t,r){return{errorCode:t,message:r}}(function(t){t.Dropbox="DROPBOX",t.Box="BOX",t.Sharefile="SHAREFILE",t.GoogleDrive="GOOGLEDRIVE",t.Egnyte="EGNYTE",t.SharePoint="SharePoint"})(o=e.CloudStorageProvider||(e.CloudStorageProvider={})),function(t){t[t.Sharepoint=0]="Sharepoint",t[t.WopiIntegration=1]="WopiIntegration",t[t.Google=2]="Google",t[t.OneDrive=3]="OneDrive",t[t.Recent=4]="Recent",t[t.Aggregate=5]="Aggregate",t[t.FileSystem=6]="FileSystem",t[t.Search=7]="Search",t[t.AllFiles=8]="AllFiles",t[t.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(t){t.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(t){t.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(t){t.Downloaded="Downloaded",t.Downloading="Downloading",t.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(t){t.Download="DOWNLOAD",t.Upload="UPLOAD",t.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(t,r){if(s(i.content),!t||t.length===0)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!r)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");u("files.getCloudStorageFolders",[t],r)},e.addCloudStorageFolder=function(t,r){if(s(i.content),!t||t.length===0)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!r)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");u("files.addCloudStorageFolder",[t],r)},e.deleteCloudStorageFolder=function(t,r,l){if(s(i.content),!t)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!r)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!l)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");u("files.deleteCloudStorageFolder",[t,r],l)},e.getCloudStorageFolderContents=function(t,r,l){if(s(i.content),!t||!r)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!l)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in t&&!t.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");u("files.getCloudStorageFolderContents",[t,r],l)},e.openCloudStorageFile=function(t,r,l){if(s(i.content),!t||!r)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(t.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");u("files.openCloudStorageFile",[t,r,l])},e.getExternalProviders=function(t,r){if(t===void 0&&(t=!1),s(i.content),!r)throw new Error("[files.getExternalProviders] Callback cannot be null");u("files.getExternalProviders",[t],r)},e.copyMoveFiles=function(t,r,l,a,g,v){if(g===void 0&&(g=!1),s(i.content),!t||t.length===0)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!l)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!v)throw new Error("[files.copyMoveFiles] callback cannot be null");u("files.copyMoveFiles",[t,r,l,a,g],v)},e.getFileDownloads=function(t){if(s(i.content),!t)throw new Error("[files.getFileDownloads] Callback cannot be null");u("files.getFileDownloads",[],t)},e.openDownloadFolder=function(t,r){if(t===void 0&&(t=void 0),s(i.content),!r)throw new Error("[files.openDownloadFolder] Callback cannot be null");u("files.openDownloadFolder",[t],r)},e.addCloudStorageProvider=function(t){if(s(i.content),!t)throw n(p.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");u("files.addCloudStorageProvider",[],t)},e.removeCloudStorageProvider=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!t||!t.content)throw n(p.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");u("files.removeCloudStorageProvider",[t],r)},e.addCloudStorageProviderFile=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!t||!t.content)throw n(p.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");u("files.addCloudStorageProviderFile",[t],r)},e.renameCloudStorageProviderFile=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!t||!t.content)throw n(p.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");u("files.renameCloudStorageProviderFile",[t],r)},e.deleteCloudStorageProviderFile=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(t&&t.content&&t.content.itemList&&t.content.itemList.length>0))throw n(p.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");u("files.deleteCloudStorageProviderFile",[t],r)},e.downloadCloudStorageProviderFile=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(t&&t.content&&t.content.itemList&&t.content.itemList.length>0))throw n(p.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");u("files.downloadCloudStorageProviderFile",[t],r)},e.uploadCloudStorageProviderFile=function(t,r){if(s(i.content),!r)throw n(p.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(t&&t.content&&t.content.itemList&&t.content.itemList.length>0))throw n(p.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!(t.content.destinationFolder&&(t.content.providerCode===o.SharePoint?t.content.destinationFolder.isFolder:t.content.destinationFolder.isSubdirectory)&&t.content.destinationFolder.objectUrl))throw n(p.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");u("files.uploadCloudStorageProviderFile",[t],r)},e.registerCloudStorageProviderListChangeHandler=function(t){if(s(),!t)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");O("files.cloudStorageProviderListChange",t)},e.registerCloudStorageProviderContentChangeHandler=function(t){if(s(),!t)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");O("files.cloudStorageProviderContentChange",t)}}(Ze||(Ze={})),function(e){function o(){return!!E.supports.meetingRoom}e.getPairedMeetingRoomInfo=function(){return new Promise(function(n){if(s(),!o())throw m;n(X("meetingRoom.getPairedMeetingRoomInfo"))})},e.sendCommandToPairedMeetingRoom=function(n){return new Promise(function(t){if(!n||n.length==0)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(s(),!o())throw m;t(X("meetingRoom.sendCommandToPairedMeetingRoom",n))})},e.registerMeetingRoomCapabilitiesUpdateHandler=function(n){if(!n)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(s(),!o())throw m;O("meetingRoom.meetingRoomCapabilitiesUpdate",function(t){s(),n(t)})},e.registerMeetingRoomStatesUpdateHandler=function(n){if(!n)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(s(),!o())throw m;O("meetingRoom.meetingRoomStatesUpdate",function(t){s(),n(t)})},e.isSupported=o}(Je||(Je={})),function(e){function o(){return!!E.supports.notifications}e.showNotification=function(n){if(s(i.content),!o())throw m;u("notifications.showNotification",[n])},e.isSupported=o}(Qe||(Qe={})),function(e){function o(){return!!E.supports.remoteCamera}(function(n){n.Reset="Reset",n.ZoomIn="ZoomIn",n.ZoomOut="ZoomOut",n.PanLeft="PanLeft",n.PanRight="PanRight",n.TiltUp="TiltUp",n.TiltDown="TiltDown"})(e.ControlCommand||(e.ControlCommand={})),function(n){n[n.CommandResetError=0]="CommandResetError",n[n.CommandZoomInError=1]="CommandZoomInError",n[n.CommandZoomOutError=2]="CommandZoomOutError",n[n.CommandPanLeftError=3]="CommandPanLeftError",n[n.CommandPanRightError=4]="CommandPanRightError",n[n.CommandTiltUpError=5]="CommandTiltUpError",n[n.CommandTiltDownError=6]="CommandTiltDownError",n[n.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(n){n[n.None=0]="None",n[n.ControlDenied=1]="ControlDenied",n[n.ControlNoResponse=2]="ControlNoResponse",n[n.ControlBusy=3]="ControlBusy",n[n.AckTimeout=4]="AckTimeout",n[n.ControlTerminated=5]="ControlTerminated",n[n.ControllerTerminated=6]="ControllerTerminated",n[n.DataChannelError=7]="DataChannelError",n[n.ControllerCancelled=8]="ControllerCancelled",n[n.ControlDisabled=9]="ControlDisabled",n[n.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(n){if(!n)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(s(i.sidePanel),!o())throw m;u("remoteCamera.getCapableParticipants",n)},e.requestControl=function(n,t){if(!n)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(s(i.sidePanel),!o())throw m;u("remoteCamera.requestControl",[n],t)},e.sendControlCommand=function(n,t){if(!n)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(s(i.sidePanel),!o())throw m;u("remoteCamera.sendControlCommand",[n],t)},e.terminateSession=function(n){if(!n)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(s(i.sidePanel),!o())throw m;u("remoteCamera.terminateSession",n)},e.registerOnCapableParticipantsChangeHandler=function(n){if(!n)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(s(i.sidePanel),!o())throw m;O("remoteCamera.capableParticipantsChange",n)},e.registerOnErrorHandler=function(n){if(!n)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(s(i.sidePanel),!o())throw m;O("remoteCamera.handlerError",n)},e.registerOnDeviceStateChangeHandler=function(n){if(!n)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(s(i.sidePanel),!o())throw m;O("remoteCamera.deviceStateChange",n)},e.registerOnSessionStatusChangeHandler=function(n){if(!n)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(s(i.sidePanel),!o())throw m;O("remoteCamera.sessionStatusChange",n)},e.isSupported=o}($e||($e={})),function(e){function o(){return!!E.supports.appEntity}e.selectAppEntity=function(n,t,r,l){if(s(i.content),!o())throw m;if(!n||n.length==0)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!l)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");u("appEntity.selectAppEntity",[n,t,r],l)},e.isSupported=o}(et||(et={})),function(e){function o(){return!!E.supports.teams}(function(n){n[n.Regular=0]="Regular",n[n.Private=1]="Private",n[n.Shared=2]="Shared"})(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(n,t){if(s(i.content),!o())throw m;if(!n)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");u("teams.getTeamChannels",[n],t)},e.refreshSiteUrl=function(n,t){if(s(),!o())throw m;if(!n)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");u("teams.refreshSiteUrl",[n],t)},e.isSupported=o,function(n){function t(){return!!E.supports.teams&&!!E.supports.teams.fullTrust}(function(r){function l(){return!!E.supports.teams&&!!E.supports.teams.fullTrust&&!!E.supports.teams.fullTrust.joinedTeams}r.getUserJoinedTeams=function(a){return new Promise(function(g){if(s(),!l())throw m;if((h.hostClientType===c.android||h.hostClientType===c.teamsRoomsAndroid||h.hostClientType===c.teamsPhones||h.hostClientType===c.teamsDisplays)&&!oe("2.0.1")){var v={errorCode:p.OLD_PLATFORM};throw new Error(JSON.stringify(v))}g(fe("getUserJoinedTeams",a))})},r.isSupported=l})(n.joinedTeams||(n.joinedTeams={})),n.getConfigSetting=function(r){return new Promise(function(l){if(s(),!t())throw m;l(fe("getConfigSetting",r))})},n.isSupported=t}(e.fullTrust||(e.fullTrust={}))}(tt||(tt={}))})(),H})()})})(pe);class $n{constructor(y){this.canvas=y,this.gl=y.getContext("webgl2"),this.canvasWidth=0,this.canvasHeight=0,this.initalized=!1,this.program=null,this.textureY=null,this.textureUV=null,this.effectPixelBuffer=null}init(){this.initalized||(this._initProgram(),this._initVertexBuffers(),this._initTexture(),this.initalized=!0)}processVideoFrame(y){const C=this.gl,D=y.width,A=y.height;this._setSize(D,A),C.viewport(0,0,this.canvasWidth,this.canvasHeight),C.clearColor(0,0,0,0),C.clear(C.COLOR_BUFFER_BIT);const H=D*A;C.bindTexture(C.TEXTURE_2D,this.textureY),C.texImage2D(C.TEXTURE_2D,0,C.LUMINANCE,D,A,0,C.LUMINANCE,C.UNSIGNED_BYTE,y.data.subarray(0,H)),C.bindTexture(C.TEXTURE_2D,this.textureUV),C.texImage2D(C.TEXTURE_2D,0,C.LUMINANCE_ALPHA,D>>1,A>>1,0,C.LUMINANCE_ALPHA,C.UNSIGNED_BYTE,y.data.subarray(H,y.data.length)),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0),C.readPixels(0,0,D,A,C.RGBA,C.UNSIGNED_BYTE,this.effectPixelBuffer);for(let I=0;I<H;I+=1)y.data[I]=this.effectPixelBuffer[4*I];let T=0,P=0;for(let I=H;I<y.data.length;I+=2)y.data[I]=this.effectPixelBuffer[4*P+1],y.data[I+1]=this.effectPixelBuffer[4*P+2],T+=2,P+=2,T>y.width&&(P+=y.width,T=T%y.width)}_setSize(y,C){(this.canvasWidth!==y||this.canvasHeight!==C)&&(this.canvas.width=y,this.canvas.height=C,this.canvasWidth=y,this.canvasHeight=C,this.effectPixelBuffer=new Uint8Array(y*C*4))}_initProgram(){const y=`
            attribute vec4 a_vertexPosition;
            attribute vec2 a_texturePosition;
            varying vec2 v_texCoord;
            void main() {
                gl_Position = a_vertexPosition;
                v_texCoord = a_texturePosition;
            }
        `,C=`
            precision mediump float; 
            varying vec2      v_texCoord; 
            uniform sampler2D u_samplerY; 
            uniform sampler2D u_samplerUV; 

            vec3 yuv2r = vec3(1.164, 0.0, 1.596);
            vec3 yuv2g = vec3(1.164, -0.391, -0.813);
            vec3 yuv2b = vec3(1.164, 2.018, 0.0);

            vec3 nv12_to_rgb(vec2 texCoord) {
                vec3 yuv; 
                yuv.x = texture2D(u_samplerY, texCoord).r - 0.0625;
                yuv.y = texture2D(u_samplerUV, texCoord).r - 0.5;
                yuv.z = texture2D(u_samplerUV, texCoord).a - 0.5;
                vec3 rgb = vec3(dot(yuv, yuv2r), dot(yuv, yuv2g), dot(yuv, yuv2b));
                return rgb; 
            }

            vec4 rgba_to_nv12(vec3 rgb) {
                float y = (0.257 * rgb.r) + (0.504 * rgb.g) + (0.098 * rgb.b) + 0.0625;
                float u = -(0.148 * rgb.r) - (0.291 * rgb.g) + (0.439 * rgb.b) + 0.5;
                float v = (0.439 * rgb.r) - (0.368 * rgb.g) - (0.071 * rgb.b) + 0.5;
                return vec4(y, u, v, 1.0);
            }

            void main() {
                gl_FragColor = vec4(nv12_to_rgb(v_texCoord), 1); 
                // gray effect
                float luminance = 0.299 * gl_FragColor.r + 0.587 * gl_FragColor.g + 0.114 * gl_FragColor.b;
                gl_FragColor = vec4(luminance, luminance, luminance, 5);

                // rgba to nv12
                gl_FragColor = rgba_to_nv12(gl_FragColor.rgb);
            }
        `,D=this.gl,A=this._compileShader(y,D.VERTEX_SHADER),H=this._compileShader(C,D.FRAGMENT_SHADER),T=D.createProgram();if(D.attachShader(T,A),D.attachShader(T,H),D.linkProgram(T),D.useProgram(T),!D.getProgramParameter(T,D.LINK_STATUS)){console.error("program fail to link"+D.getShaderInfoLog(T));return}this.program=T}_initVertexBuffers(){const y=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]),C=this.gl,D=this.program,A=C.createBuffer();C.bindBuffer(C.ARRAY_BUFFER,A),C.bufferData(C.ARRAY_BUFFER,y,C.STATIC_DRAW);const H=C.getAttribLocation(D,"a_vertexPosition");C.vertexAttribPointer(H,3,C.FLOAT,!1,5*4,0),C.enableVertexAttribArray(H);const T=new Int16Array([0,1,2,2,1,3]),P=C.createBuffer();C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,P),C.bufferData(C.ELEMENT_ARRAY_BUFFER,T,C.STATIC_DRAW);const I=C.getAttribLocation(D,"a_texturePosition");C.vertexAttribPointer(I,2,C.FLOAT,!1,5*4,3*4),C.enableVertexAttribArray(I)}_createTexture(){const y=this.gl,C=y.createTexture();return y.bindTexture(y.TEXTURE_2D,C),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST),C}_initTexture(){const y=this.gl,C=this.program;this.textureY=this._createTexture(),y.uniform1i(y.getUniformLocation(C,"u_samplerY"),0),y.activeTexture(y.TEXTURE1),this.textureUV=this._createTexture(),y.uniform1i(y.getUniformLocation(C,"u_samplerUV"),1)}_compileShader(y,C){const D=this.gl,A=D.createShader(C);if(D.shaderSource(A,y),D.compileShader(A),!D.getShaderParameter(A,D.COMPILE_STATUS)){const T=D.getShaderInfoLog(A);D.deleteShader(A),console.error("could not compile shader",T);return}return A}}pe.exports.app.initialize().then(()=>{let ge={pixelValue:100,proportion:3},y={half:"c2cf81fd-a1c0-4742-b41a-ef969b3ed490",gray:"b0c8896c-7be8-4645-ae02-a8bc9b0355e5"},C;function D(c){const L=c.height*c.width/Math.max(1,ge.proportion)-4;for(let i=1;i<L;i+=4)c.data[i+1]=ge.pixelValue}let A=new OffscreenCanvas(480,360),H=new $n(A);H.init();function T(c,L,i){switch(C){case y.half:D(c);break;case y.gray:H.processVideoFrame(c);break}L()}function P(){document.getElementById("filter-half").classList.remove("selected"),document.getElementById("filter-gray").classList.remove("selected")}function I(c){if(console.log(c),C===c){console.log("effect not changed");return}switch(C=c,P(),C){case y.half:console.log("current effect: half"),document.getElementById("filter-half").classList.add("selected");break;case y.gray:console.log("current effect: gray"),document.getElementById("filter-gray").classList.add("selected");break;default:console.log("effect cleared");break}}pe.exports.video.registerForVideoEffect(I),pe.exports.video.registerForVideoFrame(T,{format:"NV12"}),document.getElementById("filter-half").addEventListener("click",function(){C!==y.half&&pe.exports.video.notifySelectedVideoEffectChanged("EffectChanged",y.half)}),document.getElementById("filter-gray").addEventListener("click",function(){C!==y.gray&&pe.exports.video.notifySelectedVideoEffectChanged("EffectChanged",y.gray)})});
